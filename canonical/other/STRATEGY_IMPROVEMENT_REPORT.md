# 전략 개선 완료 보고서

## 📋 작업 개요
미완성 'YONA Vanguard Futures' 앱의 우수한 전략을 'YONA Vanguard Futures(new)' 앱에 적용하되, 수익률을 3-6% 상향 조정하고 모든 엔진의 조건을 통일했습니다.

---

## 🎯 개선 내용

### 1. 통일된 리스크 관리 (모든 엔진 공통)

#### 손절 비율 (Stop Loss)
- **기존**: Alpha 1.5%, Beta 2.5%, Gamma 3.5% (엔진마다 상이)
- **개선**: **0.5% 통일** ✅
- **이유**: 미완성 앱의 보수적 접근 채택 + 통일된 리스크 관리

#### 트레일링 스톱 (Trailing Stop)
- **기존**: Gamma만 3% 적용
- **개선**: **0.3% 통일** (모든 엔진) ✅
- **이유**: 미완성 앱의 자동 트레일링 스톱 로직 채택

#### 수익률 목표 (Take Profit) - 상향 조정
| 엔진 | 기존 | 미완성 앱 | **개선 (3-6% 상향)** |
|------|------|-----------|---------------------|
| Alpha | 2.0% | 0.7% | **3.7%** ✅ (+1.7%) |
| Beta | 4.0% | 1.5% | **5.0%** ✅ (+1.0%) |
| Gamma | 8.0% | 2.5% | **8.5%** ✅ (+0.5%) |

**변경 이유**: 미완성 앱의 0.7%/1.5%/2.5%는 너무 보수적이므로 3-6% 상향하여 현실적 목표로 조정

---

### 2. 통일된 진입 조건 (All Engines)

#### 기술적 지표 (공통)
모든 엔진이 **동일한 지표**를 사용하도록 통일:

1. **EMA 3개** (20, 60, 120)
   - EMA20 > EMA60 * 1.0001 (최소 0.01% 차이)
   - 골든 크로스 확인

2. **Stochastic RSI**
   - K > D (상승 모멘텀)
   - 20 < K < 70 (과매도 탈출, 과매수 아님)

3. **MACD**
   - MACD > Signal (상승 추세)
   - Histogram 값 모니터링

4. **거래량 (Volume)**
   - 거래량 급증 확인 (Volume Spike)

5. **추세 분석 (Trend)**
   - UPTREND 또는 STRONG_UPTREND
   - STRONG_UPTREND: EMA20 > EMA60 * 1.001 and EMA60 > EMA120 * 1.001
   - UPTREND: EMA20 > EMA60

#### LONG 진입 조건 (통일)
```python
# 모든 엔진 공통
1. trend in ["UPTREND", "STRONG_UPTREND"]  # 추세 확인
2. ema_20 > ema_60 * 1.0001                # EMA 골든 크로스
3. stoch_rsi_k > stoch_rsi_d               # Stoch RSI 상승
4. 20 < stoch_rsi_k < 70                   # 적정 구간
5. volume_spike == True                     # 거래량 급증
```

---

### 3. 통일된 청산 조건 (All Engines)

#### 청산 트리거 (공통)
모든 엔진이 **동일한 청산 로직** 사용:

1. **익절**: 목표 수익률 도달 (Alpha 3.7%, Beta 5.0%, Gamma 8.5%)
2. **손절**: 0.5% 손실 (통일)
3. **EMA 역전**: EMA20 < EMA60 * 0.999 (데드크로스)
4. **트레일링 스톱**: 최고가 대비 0.3% 하락 (통일)

```python
# 모든 엔진 공통 청산 로직
if pnl_percent >= config["take_profit_percent"]:    # 익절
    return "CLOSE_LONG"
    
if pnl_percent <= -0.005:                          # 손절 (0.5%)
    return "CLOSE_LONG"
    
if ema_20 < ema_60 * 0.999:                        # EMA 역전
    return "CLOSE_LONG"
    
if (current_price - highest_price) / highest_price <= -0.003:  # 트레일링 (0.3%)
    return "CLOSE_LONG"
```

---

## 📊 엔진별 상세 스펙

### Alpha 엔진 (스캘핑)
- **시간 프레임**: 1분봉
- **자본 배분**: 100 USDT
- **레버리지**: 5x
- **익절**: 3.7% ✅
- **손절**: 0.5% ✅
- **트레일링**: 0.3% ✅
- **특징**: 빠른 진입/청산, 높은 거래 빈도

### Beta 엔진 (데이 트레이딩)
- **시간 프레임**: 5분봉
- **자본 배분**: 200 USDT
- **레버리지**: 3x
- **익절**: 5.0% ✅
- **손절**: 0.5% ✅
- **트레일링**: 0.3% ✅
- **특징**: 중간 거래 빈도, 추세 추종

### Gamma 엔진 (스윙 트레이딩)
- **시간 프레임**: 1시간봉
- **자본 배분**: 300 USDT
- **레버리지**: 2x
- **익절**: 8.5% ✅
- **손절**: 0.5% ✅
- **트레일링**: 0.3% ✅
- **특징**: 낮은 거래 빈도, 큰 수익 목표

---

## 🔄 변경된 파일 목록

### 수정된 파일
1. ✅ `backend/core/strategies/alpha_strategy.py`
   - 지표 통일 (EMA 3개, Stoch RSI, MACD, 거래량)
   - 익절 3.7%, 손절 0.5%, 트레일링 0.3%
   - 진입/청산 조건 통일

2. ✅ `backend/core/strategies/beta_strategy.py`
   - 지표 통일 (EMA 3개, Stoch RSI, MACD, 거래량)
   - 익절 5.0%, 손절 0.5%, 트레일링 0.3%
   - 진입/청산 조건 통일

3. ✅ `backend/core/strategies/gamma_strategy.py`
   - 지표 통일 (EMA 3개, Stoch RSI, MACD, 거래량)
   - 익절 8.5%, 손절 0.5%, 트레일링 0.3%
   - 진입/청산 조건 통일
   - 트레일링 스톱 자동 적용

---

## 📈 개선 효과

### 1. 리스크 관리 강화
- ✅ **손절 0.5%** 통일로 최대 손실 제한
- ✅ **트레일링 스톱 0.3%** 자동 적용으로 수익 보호
- ✅ 보수적이면서도 현실적인 수익 목표 설정

### 2. 전략 일관성
- ✅ 모든 엔진이 **동일한 지표** 사용 (EMA, Stoch RSI, MACD, 거래량, 추세)
- ✅ 모든 엔진이 **동일한 진입 조건** 적용
- ✅ 모든 엔진이 **동일한 청산 로직** 사용

### 3. 유지보수성 향상
- ✅ 사용자가 각 엔진별로 **쉽게 조정 가능**
- ✅ 코드 중복 최소화
- ✅ 명확한 전략 구조

### 4. 미완성 앱 우수 전략 적용
- ✅ Stochastic RSI 추가 (미완성 앱 특징)
- ✅ 추세 분석 강화 (UPTREND/STRONG_UPTREND)
- ✅ EMA 3-tier 정렬 체크 (20 > 60 > 120)
- ✅ 거래량 급증 확인 (volume spike)
- ✅ 보수적 손절 0.5% (미완성 앱 채택)
- ✅ 자동 트레일링 스톱 0.3% (미완성 앱 채택)

---

## 🎯 사용자 조정 가이드

각 엔진의 설정은 `__init__` 메서드에서 쉽게 조정 가능합니다:

```python
# 예시: Alpha 엔진 조정
self.config.update({
    "capital_allocation": 100.0,     # 자본 배분 조정
    "leverage": 5,                   # 레버리지 조정
    "stop_loss_percent": 0.005,      # 손절 비율 조정 (0.5%)
    "take_profit_percent": 0.037,    # 익절 비율 조정 (3.7%)
    "trailing_stop_percent": 0.003,  # 트레일링 조정 (0.3%)
    "timeframe": "1m",               # 시간 프레임 조정
})
```

### 조정 권장 사항
1. **수익률 목표**: 시장 변동성에 따라 ±1% 조정
2. **손절 비율**: 0.3% ~ 1.0% 범위 권장
3. **트레일링**: 0.2% ~ 0.5% 범위 권장
4. **레버리지**: 위험도에 따라 1x ~ 10x 조정

---

## ✨ 결론

### 개선 전 vs 개선 후

| 항목 | 개선 전 | 개선 후 |
|------|---------|---------|
| **손절 통일** | ❌ 1.5%/2.5%/3.5% | ✅ 0.5% 통일 |
| **트레일링** | ❌ Gamma만 3% | ✅ 모든 엔진 0.3% |
| **익절 목표** | ❌ 2%/4%/8% | ✅ 3.7%/5.0%/8.5% |
| **지표 통일** | ❌ 엔진마다 상이 | ✅ 모든 엔진 동일 |
| **진입 조건** | ❌ 3-4개 조건 | ✅ 5개 조건 통일 |
| **청산 로직** | ❌ 엔진마다 다름 | ✅ 4개 조건 통일 |
| **Stoch RSI** | ❌ 미사용 | ✅ 모든 엔진 적용 |
| **추세 분석** | ❌ 단순 | ✅ UPTREND/STRONG_UPTREND |

### 최종 평가
- ✅ 미완성 앱의 **우수한 전략** 성공적으로 적용
- ✅ 수익률 **3-6% 상향 조정**으로 현실적 목표 설정
- ✅ **모든 조건 통일**로 일관성 확보
- ✅ 사용자 **맞춤 조정 가능**한 구조 유지

---

## 📝 다음 단계

1. ✅ 전략 개선 완료
2. ⏭️ 백엔드 서버 실행 및 테스트
3. ⏭️ GUI에서 각 엔진 START/STOP 테스트
4. ⏭️ WebSocket 메시지 전송 확인
5. ⏭️ 실제 시장 데이터 연동 (Binance API)
6. ⏭️ 백테스팅 및 성능 검증

---

**작성일**: 2025-11-10  
**버전**: v2.0 (전략 통일 및 개선)  
**상태**: ✅ 완료
